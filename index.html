<!DOCTYPE html>
<html lang="pt-BR"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MT Lex - Assistente Jur√≠dico Inteligente</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Bot√£o para abrir sidebar em mobile -->
    <button class="sidebar-toggle" onclick="toggleSidebar()">‚ò∞</button>

    <!-- Overlay para fechar sidebar em mobile -->
    <div class="sidebar-overlay" onclick="closeSidebar()"></div>

    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">MT Lex</h2>
                <p class="sidebar-subtitle">Menu de Funcionalidades</p>
            </div>

            <nav class="sidebar-nav">
                <!-- Se√ß√£o de Templates -->
                <div class="sidebar-section">
                    <h3 class="sidebar-section-title">üìã Templates</h3>
                    <div class="template-selector-container">
                        <label for="templateSelector" class="template-label">Selecione um template</label>
                        <div class="template-controls">
                            <select id="templateSelector" class="template-select" onchange="loadTemplate()">
                                <option value="" disabled selected>Escolha um template...</option>
                            </select>
                            <button id="createTemplateBtn" class="create-template-btn" onclick="openCreateTemplateModal()" title="Criar template a partir dos t√≥picos atuais">
                                ‚ûï Criar Template
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Se√ß√£o de Contratos -->
                <div class="sidebar-section">
                    <h3 class="sidebar-section-title">üìÑ Contratos</h3>
                    <div class="contract-menu">
                        <button class="contract-btn" onclick="selectContract('contrato-social')">
                            <span class="contract-icon">üè¢</span>
                            <span class="contract-name">Contrato Social</span>
                        </button>
                        <button class="contract-btn" onclick="selectContract('acordo-socio')">
                            <span class="contract-icon">ü§ù</span>
                            <span class="contract-name">Acordo de S√≥cio</span>
                        </button>
                        <button class="contract-btn" onclick="selectContract('protocolo-familiar')">
                            <span class="contract-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                            <span class="contract-name">Protocolo Familiar</span>
                        </button>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
        <!-- Header com login/logout -->
        <div class="header">
            <div class="user-section" id="userSection">
                <div id="loginSection" class="login-section">
                    <button id="loginBtn" class="login-btn">üë§ Entrar</button>
                </div>
                <div id="userInfo" class="user-info" style="display: none;">
                    <span id="userEmail"></span>
                    <button id="logoutBtn" class="logout-btn">Sair</button>
                </div>
            </div>
            <h1>MT Lex</h1>
            <p class="instruction">
                Assistente Jur√≠dico Inteligente<br>
                Cole seu texto jur√≠dico no campo abaixo e descubra como nossa IA pode aprimorar suas teses.
            </p>
        </div>

        <div class="input-area">
            <div class="input-wrapper">
                <textarea id="inputText" placeholder="Cole aqui o texto da sua tese jur√≠dica..."></textarea>
                <div class="button-group">
                    <button id="improveBtn" onclick="improvePrompt()" title="Melhorar Prompt">
                        ‚ú®
                    </button>
                    <button class="send-button" id="generateBtn" onclick="generateThesis()">
                        ‚Üë
                    </button>
                </div>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>MT Lex analisando sua tese...</p>
        </div>

        <div class="result" id="result">
            <h2>An√°lise MT Lex:</h2>
            <div id="analiseContainer" style="display: none;">
                <h3>An√°lise do Prompt</h3>
                <div>
                    <h4>Sugest√µes de Melhora</h4>
                    <p id="sugestoesMelhora"></p>
                </div>
                <div>
                    <h4>Lacunas Identificadas</h4>
                    <p id="lacunasIdentificadas"></p>
                </div>
                <div>
                    <h4>Perguntas Complementares</h4>
                    <ul id="perguntasComplementares"></ul>
                </div>
            </div>

            <!-- Nova se√ß√£o da lista edit√°vel de t√≥picos -->
            <div id="topicsSection" style="display: none;">
                <h3 style="color: #ececf1; margin-bottom: 16px; font-size: 1.2em;">T√≥picos da Tese:</h3>

                <ul id="resultado" class="editable-topics-list"></ul>
                <button id="addTopicBtn" class="add-topic-btn">+ Adicionar T√≥pico</button>
                <div class="action-buttons">
                    <button id="developSelectedBtn" class="develop-btn">Desenvolver T√≥picos Selecionados</button>
                </div>
            </div>

            <!-- Se√ß√£o para exibir os desenvolvimentos -->
            <div id="developmentsSection" style="display: none;">
                <h3 style="color: #ececf1; margin: 24px 0 16px; font-size: 1.2em;">Desenvolvimentos dos T√≥picos:</h3>
                <div id="developmentsContainer" class="developments-container"></div>
                <button id="clearDevelopmentsBtn" class="clear-developments-btn" onclick="clearDevelopments()">Limpar Desenvolvimentos</button>
            </div>

            <div class="result-content" id="resultContent"></div>
        </div>

        <!-- Modal de Login -->
        <div id="loginModal" class="modal-overlay" style="display: none;">
            <div class="modal-container">
                <div class="modal-header">
                    <h3 class="modal-title">üîê Entrar no MT Lex</h3>
                    <button class="modal-close-btn" onclick="closeLoginModal()">‚úï</button>
                </div>
                <div class="modal-body">
                    <div class="auth-tabs">
                        <button id="loginTab" class="auth-tab active" onclick="showLoginTab()">Entrar</button>
                        <button id="signupTab" class="auth-tab" onclick="showSignupTab()">Criar Conta</button>
                    </div>

                    <!-- Formul√°rio de Login -->
                    <div id="loginForm" class="auth-form">
                        <div class="input-group">
                            <label for="loginEmail" class="input-label">E-mail:</label>
                            <input type="email" id="loginEmail" class="auth-input" placeholder="seu@email.com">
                        </div>
                        <div class="input-group">
                            <label for="loginPassword" class="input-label">Senha:</label>
                            <input type="password" id="loginPassword" class="auth-input" placeholder="Sua senha">
                        </div>
                        <button id="loginSubmitBtn" class="auth-submit-btn">üîë Entrar</button>
                    </div>

                    <!-- Formul√°rio de Registro -->
                    <div id="signupForm" class="auth-form" style="display: none;">
                        <div class="input-group">
                            <label for="signupEmail" class="input-label">E-mail:</label>
                            <input type="email" id="signupEmail" class="auth-input" placeholder="seu@email.com">
                        </div>
                        <div class="input-group">
                            <label for="signupPassword" class="input-label">Senha:</label>
                            <input type="password" id="signupPassword" class="auth-input" placeholder="M√≠nimo 6 caracteres">
                        </div>
                        <div class="input-group">
                            <label for="signupName" class="input-label">Nome:</label>
                            <input type="text" id="signupName" class="auth-input" placeholder="Seu nome">
                        </div>
                        <button id="signupSubmitBtn" class="auth-submit-btn">‚ú® Criar Conta</button>
                    </div>

                    <div id="authMessage" class="auth-message"></div>
                </div>
            </div>
        </div>

        <!-- Modal para criar template customizado -->
        <div id="createTemplateModal" class="modal-overlay" style="display: none;">
            <div class="modal-container">
                <div class="modal-header">
                    <h3 class="modal-title">üõ†Ô∏è Criar Template Personalizado</h3>
                    <button class="modal-close-btn" onclick="closeCreateTemplateModal()">‚úï</button>
                </div>
                <div class="modal-body">
                    <p class="modal-description">
                        Criar um template com os <strong id="topicCount">0</strong> t√≥picos atuais:
                    </p>
                    <div id="topicPreview" class="topic-preview"></div>
                    <div class="input-group">
                        <label for="templateName" class="input-label">Nome do Template:</label>
                        <input type="text" id="templateName" class="template-name-input" placeholder="Ex: Meu Contrato Personalizado" maxlength="50">
                        <div class="input-helper">O template ficar√° dispon√≠vel no menu de sele√ß√£o</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="modal-cancel-btn" onclick="closeCreateTemplateModal()">Cancelar</button>
                    <button class="modal-save-btn" onclick="saveCustomTemplate()">üíæ Salvar Template</button>
                </div>
            </div>
        </div>
            </div>
        </main>
    </div>

    <script type="module">
  import { createClient } from 'https://cdn.skypack.dev/@supabase/supabase-js'
  window.supabase = createClient('https://hcifazxfebcdavmzvkbr.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhjaWZhenhmZWJjZGF2bXp2a2JyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMDU0MzUsImV4cCI6MjA3Mzg4MTQzNX0.KE86kn-Fu3Gn_D7tYEiGB3avm37JSiPXM-pPGnWB8PI')
  </script>
  <script src="script.js"></script>
</body>
</html>
